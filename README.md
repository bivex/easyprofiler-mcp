# EasyProfiler MCP Server

MCP (Model Context Protocol) сервер для анализа файлов профилирования EasyProfiler (.prof).

✅ **Протестировано** на реальном 160MB файле с 6M+ блоками
⚡ **Готово к использованию** с Claude Desktop

## Возможности

Сервер предоставляет следующие инструменты для анализа производительности:

### Инструменты

1. **load_profile** - Загружает .prof файл для анализа
   - Параметры: `file_path` (путь к .prof файлу)

2. **get_slowest_blocks** - Возвращает топ самых медленных блоков выполнения
   - Параметры: `limit` (количество блоков, по умолчанию 10)

3. **get_thread_statistics** - Статистика использования времени по потокам
   - Без параметров

4. **get_hotspots** - Горячие точки - функции с наибольшим временем выполнения
   - Параметры: `limit` (количество, по умолчанию 10)

5. **analyze_performance_issues** - Комплексный анализ проблем производительности
   - Без параметров
   - Выявляет: длительные блокировки, дисбаланс потоков, переключения контекста

## Установка

```bash
go mod download
go build -o easyprofiler-mcp
```

## Использование

### Запуск сервера

```bash
./easyprofiler-mcp
```

### Конфигурация MCP клиента

Добавьте в конфигурацию вашего MCP клиента (например, Claude Desktop):

```json
{
  "mcpServers": {
    "easyprofiler": {
      "command": "/path/to/easyprofiler-mcp"
    }
  }
}
```

## Формат .prof файла

Сервер поддерживает формат EasyProfiler версий:
- v1.0.0+
- v1.3.0+
- v2.0.0+
- v2.1.0+

## Пример использования

1. Загрузите профиль:
   ```
   load_profile(file_path="/path/to/profile.prof")
   ```

2. Получите анализ проблем:
   ```
   analyze_performance_issues()
   ```

3. Просмотрите самые медленные блоки:
   ```
   get_slowest_blocks(limit=20)
   ```

## Типы выявляемых проблем

- **Long Blocking Operations** - операции блокировки длительностью > 100ms
- **Thread Imbalance** - дисбаланс нагрузки между потоками (разница > 2x)
- **Excessive Context Switches** - чрезмерное количество переключений контекста (> 1000)
- **Hot Functions** - функции занимающие > 10% общего времени

## Лицензия

MIT
